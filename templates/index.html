<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Home Rail Quote Form</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f4f6f9;
        margin: 0;
        padding: 30px;
      }
      .container {
        display: flex;
        justify-content: center;
        gap: 20px;
      }
      .form-section {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        flex: 3;
        max-width: 800px;
      }
      .quote-list {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        flex: 1;
        max-height: 600px;
        overflow-y: auto;
        min-width: 220px;
      }
      .row {
        display: flex;
        gap: 20px;
      }
      .row label,
      .row input,
      .row select,
      .row textarea {
        flex: 1;
      }
      label {
        font-weight: bold;
        display: block;
        margin-top: 10px;
      }
      input[type="text"],
      input[type="number"],
      input[type="date"],
      select,
      textarea {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        margin-bottom: 10px;
      }
      button {
        margin-top: 10px;
        margin-right: 5px;
        padding: 8px 16px;
        font-weight: bold;
        background-color: #0d3c61;
        color: white;
        border: none;
        cursor: pointer;
      }
      h3,
      h2 {
        margin-top: 0;
      }
      .quote-entry {
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 1px solid #ccc;
      }
      .quote-entry button {
        background-color: #0d3c61;
        margin-right: 5px;
      }
      .quote-entry button.delete {
        background-color: darkred;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- FORM SECTION -->
      <div class="form-section">
        <h2>Home Rail Quote Form</h2>
        <form
          method="POST"
          action="/submit"
          enctype="multipart/form-data"
          id="quoteForm"
        >
          <div class="row">
            <div>
              <label>Name:</label><input type="text" name="ClientName" />
            </div>
            <div><label>Phone:</label><input type="text" name="Phone" /></div>
          </div>
          <div class="row">
            <div><label>Area:</label><input type="text" name="Area" /></div>
            <div>
              <label>Date:</label><input type="date" name="QuoteDate" />
            </div>
          </div>
          <div class="row">
            <div>
              <label>Address:</label><input type="text" name="Address" />
            </div>
            <div><label>Email:</label><input type="text" name="Email" /></div>
          </div>
          <div class="row">
            <div>
              <label>Quoted By:</label><input type="text" name="QuotedBy" />
            </div>
            <div>
              <label>Rail Color:</label>
              <select name="RailColor">
                <option>Black</option>
                <option>White</option>
                <option>Linen</option>
                <option>Sable</option>
                <option>Bronze</option>
                <option>Silver</option>
                <option>Brown</option>
                <option>Unknown</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Vinyl Color (Deck):</label>
              <select name="VinylColor">
                <option>Granite</option>
                <option>Natural</option>
                <option>Sage</option>
                <option>Platinum</option>
                <option>Carbon</option>
                <option>Ivory</option>
                <option>Pebble Grey</option>
                <option>Pebble Beige</option>
                <option>Cypress</option>
                <option>Mahogany</option>
                <option>Birch Plank</option>
                <option>Fir Plank</option>
                <option>Unknown</option>
              </select>
            </div>
            <div>
              <label>Install Type:</label>
              <select name="InstallType">
                <option>Installed</option>
                <option>Supply Only</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Lead Time:</label>
              <select name="LeadTime">
                <option>PU same Day</option>
                <option>2-3 days</option>
                <option>1 week</option>
                <option>2 weeks</option>
                <option>3 Weeks</option>
                <option>4 Weeks</option>
                <option>5 Weeks</option>
              </select>
            </div>
            <div>
              <label>Payment:</label>
              <select name="Payment">
                <option>Visa</option>
                <option>MC</option>
                <option>Amex</option>
              </select>
            </div>
          </div>
          <label>Install Notes:</label>
          <textarea name="InstallNotes" rows="3"></textarea>

          <label>Product:</label>
          <select name="Product">
            <option>Clear Windwall 90" 2 panel</option>
            <option>clear windwall 72"</option>
            <option>Stair Glass</option>
            <option>Solar Grey Glass</option>
            <option>Solar Grey Stairs</option>
            <option>68 mm Vinyl</option>
            <option>Topless Glass 42" High</option>
            <option>Urban 42" High</option>
            <option>Glass Gate</option>
            <option>Side Mount Glass 42 clear</option>
            <option>Side mount Picket 42</option>
            <option>Wide Picket 42" High</option>
            <option>Cross Hatch 42" High</option>
          </select>

          <div class="row">
            <div>
              <label>Footage (ft):</label><input type="number" name="Footage" />
            </div>
            <div>
              <label>Price per FT ($):</label
              ><input type="number" name="PricePerFt" />
            </div>
          </div>

          <!-- IMAGE SECTION -->
          <label>Upload Optional Image:</label>
          <input type="file" name="fileUpload" />

          <label>Extra Image 1:</label>
          <input type="file" name="extraImage1" />

          <label>Extra Image 2:</label>
          <input type="file" name="extraImage2" />

          <button type="submit">Generate Quote PDF</button>
        </form>
      </div>

      <!-- SAVED QUOTES SECTION -->
      <div class="quote-list">
        <h3>Saved Quotes</h3>
        {% if quotes %}
        <script>
          const savedQuotes = {};
        </script>
        {% for q in quotes %}
        <div class="quote-entry" id="quote-{{ q.id }}">
          <strong>{{ q.data.ClientName }}</strong> â€“ {{ q.timestamp }}<br />
          <button type="button" onclick="loadQuote('{{ q.id }}')">
            Load Quote
          </button>
          <button
            type="button"
            class="delete"
            onclick="deleteQuote('{{ q.id }}')"
          >
            Delete
          </button>
          <script>
            savedQuotes["{{ q.id }}"] = {{ q.data | tojson | safe }};
          </script>
        </div>
        {% endfor %} {% else %}
        <p>No saved quotes yet.</p>
        {% endif %}
      </div>
    </div>

    <script>
      function loadQuote(id) {
        const data = savedQuotes[id];
        if (!data) {
          alert("Quote not found.");
          return;
        }

        const form = document.getElementById("quoteForm");
        for (const key in data) {
          const el = form.elements.namedItem(key);
          if (el) el.value = data[key];
        }
      }

      function deleteQuote(id) {
        fetch(`/delete/${id}`, { method: "DELETE" })
          .then(() => window.location.reload())
          .catch(() => alert("Failed to delete quote."));
      }
    </script>
  </body>
</html>
